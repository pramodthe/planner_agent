type: "openagents.agents.collaborator_agent.CollaboratorAgent"
agent_id: "hotel-agent"

config:
  model_name: "gpt-5-nano-2025-08-07"
  max_iterations: 6

  tools:
    - name: "search_hotels_serpapi"
      description: "Search hotels using Google Hotel Search via SerpApi."
      implementation: "tools.hotel_search.search_hotels_serpapi"

  instruction: |
    You are the HOTEL AGENT.
    Your job: return at least 3 hotel options with nightly + total price estimates and booking links.

    Tooling:
    - Use the Python tool: search_hotels_serpapi

    Output contract (MANDATORY):
    - Provide >= 3 options in results.options (or fewer only if none exist; explain why)
    - Each option MUST include: name, neighborhood, rating, price_per_night, total_price, booking_link, source
    - Also compute from the returned set:
      - cheapest_option (min total_price or price_per_night)
      - most_expensive_option (max total_price or price_per_night)
      - best_value_option (your recommendation + brief rationale)

    Do NOT talk to the user directly. Always send results to travel-coordinator via event task.complete.

  react_to_all_messages: false

  triggers:
    - event: "project.notification.message_received"
      instruction: |
        Ignore chat. Wait for task events.
        finish()

    - event: "search.hotels"
      instruction: |
        Extract from payload:
          - task_id (required)
          - destination (city)
          - checkin_date, checkout_date
          - travelers (guests; default 1)
          - rooms (default 1 if not provided)
          - budget_preference (budget|luxury|unspecified)

        Call Tool:
          - search_hotels_serpapi(destination=destination, checkin_date, checkout_date, travelers=travelers, budget_preference=budget_preference)
          - price_preference:
              if budget_preference == "budget" -> "cheapest"
              if budget_preference == "luxury" -> "luxury"
              else -> "best_value"
          - max_results: 10

        From returned options:
          - select at least 3 distinct options (vary by neighborhood/price/rating if possible)
          - compute cheapest and most expensive from the set you are returning

        Send:
          send_event(event_name="task.complete", destination_id="travel-coordinator", payload={
            "task_id": task_id,
            "results": {
              "status": "success",
              "currency": "<currency>",
              "options": [ ...minimum 3... ],
              "cheapest_option": { ... },
              "most_expensive_option": { ... },
              "best_value_option": { ... },
              "disclaimer": "Prices are a snapshot and may change at booking."
            }
          })

        finish()

mods:
  - name: "openagents.mods.workspace.project"
    enabled: true
  - name: "openagents.mods.workspace.default"
    enabled: true
  - name: "openagents.mods.workspace.messaging"
    enabled: true

connection:
  host: "localhost"
  port: 8700
  agent_group: "booking_agents"
  password_hash: "ec93f6d39afff76e75cdeb160d1b2f419c87210d5a6c108d1f905f76ea4aa589"
  encryption_enabled: false
  transport: "grpc"
  retry_attempts: 5
  retry_delay: 2
